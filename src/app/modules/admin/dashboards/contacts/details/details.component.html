<div class="flex w-full flex-col">
    <!-- View mode -->
    @if (!editMode) {
        <!-- Header -->
        <div
            class="relative h-40 w-full bg-accent-100 px-8 dark:bg-accent-700 sm:h-48 sm:px-12"
        >
            <!-- Background -->
            <!-- @if (contact.background) {
                <img
                    class="absolute inset-0 h-full w-full object-cover"
                    [src]="contact.background"
                />
            } -->
            <!-- Close button -->
            <div
                class="mx-auto flex w-full max-w-3xl items-center justify-end pt-6"
            >
                <a
                    mat-icon-button
                    [matTooltip]="'Close'"
                    [routerLink]="['../']"
                >
                    <mat-icon
                        class="text-black"
                        [svgIcon]="'heroicons_outline:x-mark'"
                    ></mat-icon>
                </a>
            </div>
        </div>

        <!-- Contact -->
        <div
            class="relative flex flex-auto flex-col items-center p-6 pt-0 sm:p-12 sm:pt-0"
        >
            <div class="w-full max-w-3xl">
                <!-- Avatar and actions -->
                <div class="-mt-16 flex flex-auto items-end">
                    <!-- Avatar -->
                    <div
                        class="ring-bg-card flex h-32 w-32 items-center justify-center overflow-hidden rounded-full ring-4"
                    >
                        @if (contact.avatar) {
                            <img
                                class="h-full w-full object-cover"
                                [src]="contact.avatar"
                            />
                        }
                        @if (!contact.avatar) {
                            <div
                                class="flex h-full w-full items-center justify-center overflow-hidden rounded bg-gray-200 text-8xl font-bold uppercase leading-none text-gray-600 dark:bg-gray-700 dark:text-gray-200"
                            >
                                {{ contact.nom.charAt(0) }}
                            </div>
                        }
                    </div>
                    <!-- Actions -->
                    <div class="mb-1 ml-auto flex items-center">
                        <button
                            mat-stroked-button
                            (click)="toggleEditMode(true)"
                        >
                            <mat-icon
                                class="icon-size-5"
                                [svgIcon]="'heroicons_solid:pencil-square'"
                            ></mat-icon>
                            <span class="ml-2">Edit</span>
                        </button>
                    </div>
                </div>

                <!-- Name -->
                <div class="mt-3 truncate text-4xl font-bold">
                    {{ contact.nom }}
                </div>

                <!-- Tags -->
                <!-- @if (contact.tags.length) {
                    <div class="mt-2 flex flex-wrap items-center"> -->
                        <!-- Tag -->
                        <!-- @for (
                            tag of contact.tags | fuseFindByKey: 'id' : tags;
                            track trackByFn($index, tag)
                        ) {
                            <div
                                class="mb-3 mr-3 flex items-center justify-center rounded-full bg-gray-100 px-3 py-1 leading-normal text-gray-500 dark:bg-gray-700 dark:text-gray-300"
                            >
                                <span
                                    class="whitespace-nowrap text-sm font-medium"
                                    >{{ tag.title }}</span
                                >
                            </div>
                        }
                    </div> -->
                <!-- } -->

                <div class="mt-4 flex flex-col space-y-8 border-t pt-6">
                    <!-- Title -->
                    @if (contact.banque) {
                        <div class="flex sm:items-center">
                            <mat-icon
                                [svgIcon]="'heroicons_outline:office-building'"
                            ></mat-icon>
                            <div class="ml-6 leading-6">
                                {{ contact.banque }}
                            </div>
                        </div>
                    }

                    <!-- Company -->
                    @if (contact.solde) {
                        <div class="flex sm:items-center">
                            <mat-icon
                                [svgIcon]="
                                    'heroicons_outline:currency-dollar'
                                "
                            ></mat-icon>
                            <div class="ml-6 leading-6">
                                {{ contact.solde }} TND
                            </div>
                        </div>
                    }

                    <!-- Emails -->
                    @if (contact.email) {
                        <div class="flex">
                            <mat-icon
                                [svgIcon]="'heroicons_outline:envelope'"
                            ></mat-icon>
                            <div class="ml-6 min-w-0 space-y-1">
                                    <div class="flex items-center leading-6">
                                        <a
                                            class="text-primary-500 hover:underline"
                                            [href]="'mailto:' + contact.email"
                                            target="_blank"
                                        >
                                            {{ contact.email }}
                                        </a>
                                        <!-- @if (email.label) {
                                            <div
                                                class="text-secondary truncate text-md"
                                            >
                                                <span class="mx-2">&bull;</span>
                                                <span class="font-medium">{{
                                                    email.label
                                                }}</span>
                                            </div>
                                        } -->
                                    </div>
                            </div>
                        </div>
                    }

                    <!-- Phone -->
                    @if (contact.tel1 || contact.tel2) {
                        <div class="flex">
                            <mat-icon
                                [svgIcon]="'heroicons_outline:phone'"
                            ></mat-icon>
                            <div class="ml-6 min-w-0 space-y-1">
                                <!-- @for (
                                    phoneNumber of contact.phoneNumbers;
                                    track trackByFn($index, phoneNumber)
                                ) { -->
                                    <div class="flex items-center leading-6">
                                        <!-- <div
                                            class="hidden h-4 w-6 overflow-hidden sm:flex"
                                            [matTooltip]="
                                                getCountryByIso(
                                                    phoneNumber.country
                                                ).name
                                            "
                                            [style.background]="
                                                'url(\'/images/apps/contacts/flags.png\') no-repeat 0 0'
                                            "
                                            [style.backgroundSize]="
                                                '24px 3876px'
                                            "
                                            [style.backgroundPosition]="
                                                getCountryByIso(
                                                    phoneNumber.country
                                                ).flagImagePos
                                            "
                                        ></div> -->
                                        <!-- <div class="font-mono sm:ml-3">
                                            {{
                                                getCountryByIso(
                                                    phoneNumber.country
                                                ).code
                                            }}
                                        </div> -->
                                        <div class="ml-2.5 font-mono">
                                            {{ contact.tel1 }}
                                        </div>
                                        <!-- @if (phoneNumber.label) {
                                            <div
                                                class="text-secondary truncate text-md"
                                            >
                                                <span class="mx-2">&bull;</span>
                                                <span class="font-medium">{{
                                                    phoneNumber.label
                                                }}</span>
                                            </div>
                                        } -->
                                    </div>
                                    <div class="flex items-center leading-6">
                                        <div class="ml-2.5 font-mono">
                                            {{ contact.tel2 }}
                                        </div>
                                    </div>
                                <!-- } -->
                            </div>
                        </div>
                    }

                    <!-- Address -->
                    @if (contact.adresse) {
                        <div class="flex sm:items-center">
                            <mat-icon
                                [svgIcon]="'heroicons_outline:map-pin'"
                            ></mat-icon>
                            <div class="ml-6 leading-6">
                                {{ contact.adresse }}
                            </div>
                        </div>
                    }

                    <!-- Status -->
                     @if (contact.status) {
                        <div class="flex sm:items-center">
                            <!--if status is 'Unconfirmed' show a yellow button that says 'En attente', and when clicked it executes the function 'activate(contact)', if status is 'Active', it shows up as green and does nothing, if status is 'Pending' or 'Blocked' it shows up as red and does nothing-->
                            <button
                                mat-stroked-button
                                (click)="activate(contact)"
                                [ngClass]="{
                                    'bg-yellow-500 text-white': contact.status === 'Unconfirmed',
                                    'bg-green-500 text-white': contact.status === 'Active',
                                    'bg-red-500 text-white': contact.status === 'Pending' || contact.status === 'Blocked'
                                }"
                            >
                                {{ contact.status }}
                            </button>
                        </div>
                    }

                    <!-- Birthday -->
                    <!-- @if (contact.birthday) {
                        <div class="flex sm:items-center">
                            <mat-icon
                                [svgIcon]="'heroicons_outline:cake'"
                            ></mat-icon>
                            <div class="ml-6 leading-6">
                                {{ contact.birthday | date: 'longDate' }}
                            </div>
                        </div>
                    } -->

                    <!-- Notes -->
                    <!-- @if (contact.notes) {
                        <div class="flex">
                            <mat-icon
                                [svgIcon]="
                                    'heroicons_outline:bars-3-bottom-left'
                                "
                            ></mat-icon>
                            <div
                                class="prose prose-sm ml-6 max-w-none"
                                [innerHTML]="contact.notes"
                            ></div>
                        </div>
                    } -->
                </div>
            </div>
        </div>
    }

    <!-- Edit mode -->
    <!--TODO add back edit mode-->
</div>
